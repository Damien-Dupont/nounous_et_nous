-- MySQL Script generated by MySQL Workbench
-- Thu Dec 22 22:30:35 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `mydb` ;

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
-- -----------------------------------------------------
-- Schema nounous
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `nounous` ;

-- -----------------------------------------------------
-- Schema nounous
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `nounous` DEFAULT CHARACTER SET utf8 ;
-- -----------------------------------------------------
-- Schema nounou
-- -----------------------------------------------------
-- This schema was created for a stub table
DROP SCHEMA IF EXISTS `nounou` ;

-- -----------------------------------------------------
-- Schema nounou
--
-- This schema was created for a stub table
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `nounou` ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`user` (
  `id_user` INT NOT NULL AUTO_INCREMENT,
  `firstname` VARCHAR(45) NULL,
  `lastname` VARCHAR(45) NOT NULL,
  `role` VARCHAR(45) NOT NULL DEFAULT 'parent',
  PRIMARY KEY (`id_user`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`kid`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`kid` (
  `id_kid` INT NOT NULL AUTO_INCREMENT,
  `kid_lastname` VARCHAR(45) NOT NULL,
  `kid_firstname` VARCHAR(45) NOT NULL,
  `kid_birthdate` DATE NOT NULL,
  PRIMARY KEY (`id_kid`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`family`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`family` (
  `parent` INT NOT NULL,
  `child` INT NOT NULL,
  INDEX `parent_idx` (`parent` ASC) VISIBLE,
  INDEX `enfant_idx` (`child` ASC) VISIBLE,
  CONSTRAINT `parent`
    FOREIGN KEY (`parent`)
    REFERENCES `mydb`.`user` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `enfant`
    FOREIGN KEY (`child`)
    REFERENCES `mydb`.`kid` (`id_kid`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`nounou`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`nounou` (
  `idnounou` INT NOT NULL,
  `nom` VARCHAR(45) NULL,
  `prenom` VARCHAR(45) NULL,
  PRIMARY KEY (`idnounou`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`login`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`login` (
  `user_id` INT NOT NULL,
  `hashed_password` VARCHAR(200) NULL,
  `email` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`user_id`),
  CONSTRAINT `id_user`
    FOREIGN KEY (`user_id`)
    REFERENCES `nounous`.`user` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`hollidays_paiement`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`hollidays_paiement` (
  `id_rythme` INT NOT NULL AUTO_INCREMENT,
  `choice` VARCHAR(45) NULL,
  `rythm` VARCHAR(45) NULL,
  PRIMARY KEY (`id_rythme`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`contract`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`contract` (
  `id_contract` INT NOT NULL AUTO_INCREMENT,
  `nanny` INT NOT NULL,
  `kid` INT NOT NULL,
  `start_date` DATE NOT NULL,
  `holliday_pay_schedule` INT NULL DEFAULT 1,
  `holliday_pay_month` INT NULL DEFAULT 5,
  PRIMARY KEY (`id_contract`),
  INDEX `enfant_idx` (`kid` ASC) VISIBLE,
  INDEX `nounou_idx` (`nanny` ASC) VISIBLE,
  INDEX `conges_idx` (`holliday_pay_schedule` ASC) VISIBLE,
  CONSTRAINT `nounou`
    FOREIGN KEY (`nanny`)
    REFERENCES `mydb`.`user` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `enfant`
    FOREIGN KEY (`kid`)
    REFERENCES `mydb`.`kid` (`id_kid`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `conges`
    FOREIGN KEY (`holliday_pay_schedule`)
    REFERENCES `mydb`.`hollidays_paiement` (`id_rythme`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`annexes`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`annexes` (
  `id_annex` INT NOT NULL AUTO_INCREMENT,
  `contract` INT NOT NULL,
  `version` INT NULL,
  `version_date` DATE NOT NULL,
  `weeks` INT NULL,
  `days_week` INT NULL,
  `price_hour` DECIMAL(2) NULL,
  `price_ent` DECIMAL(2) NULL,
  `price_meal` DECIMAL(2) NULL,
  `price_snack` DECIMAL(2) NULL,
  `schedule` INT NULL,
  PRIMARY KEY (`id_annex`),
  INDEX `contrat_idx` (`contract` ASC) VISIBLE,
  CONSTRAINT `contrat`
    FOREIGN KEY (`contract`)
    REFERENCES `mydb`.`contract` (`id_contract`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`event`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`event` (
  `event_id` INT NOT NULL,
  `contract_id` INT NOT NULL,
  `event_type_id` INT NOT NULL,
  `starting_date` DATETIME NOT NULL,
  `ending_date` DATETIME NOT NULL,
  INDEX `id_event_type_idx` (`event_type_id` ASC) VISIBLE,
  INDEX `id_contract_idx` (`contract_id` ASC) VISIBLE,
  UNIQUE INDEX `event_id_UNIQUE` (`event_id` ASC) VISIBLE,
  CONSTRAINT `id_contract`
    FOREIGN KEY (`contract_id`)
    REFERENCES `nounous`.`contract` (`id_contract`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `id_event_type`
    FOREIGN KEY (`event_type_id`)
    REFERENCES `nounous`.`event_type` (`id_event_type`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`dayoff_types`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`dayoff_types` (
  `id_type` INT NOT NULL,
  `dayoff_type` VARCHAR(45) NULL,
  `days_max` INT NULL,
  PRIMARY KEY (`id_type`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`holldays`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`holldays` (
  `id_dayoff` INT NOT NULL AUTO_INCREMENT,
  `id_nanny` INT NOT NULL,
  `date` DATE NULL,
  `day_acquired` INT NULL,
  `day_taken` INT NULL,
  `due_limit` DATE NULL,
  `dayoff_type` INT NOT NULL,
  PRIMARY KEY (`id_dayoff`),
  INDEX `cp_nounou_idx` (`id_nanny` ASC) VISIBLE,
  INDEX `type_id` (`dayoff_type` ASC) VISIBLE,
  CONSTRAINT `cp_nounou`
    FOREIGN KEY (`id_nanny`)
    REFERENCES `mydb`.`contract` (`nanny`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `id_type`
    FOREIGN KEY (`dayoff_type`)
    REFERENCES `mydb`.`dayoff_types` (`id_type`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`calendar`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`calendar` (
  `id_calendar` INT NOT NULL AUTO_INCREMENT,
  `contract` INT NOT NULL,
  `event_date` DATE NOT NULL,
  `event_id` INT NULL,
  `event_duration` DECIMAL(2) NULL,
  `event_price` DECIMAL(2) NULL,
  `meal` INT NULL,
  `snack` INT NULL,
  PRIMARY KEY (`id_calendar`),
  INDEX `eventid_idx` (`event_id` ASC) VISIBLE,
  INDEX `contrat_idx` (`contract` ASC) VISIBLE,
  CONSTRAINT `eventid`
    FOREIGN KEY (`event_id`)
    REFERENCES `mydb`.`event` (`id_event`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `contrat`
    FOREIGN KEY (`contract`)
    REFERENCES `mydb`.`contract` (`id_contract`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`schedule`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`schedule` (
  `idplanning` INT NULL,
  `idannexe` INT NULL,
  `semaine` INT NULL,
  `jour` INT NULL,
  `idevent` INT NULL,
  `debut` DATETIME NULL,
  `duree` DECIMAL(2) NULL,
  INDEX `event_idx` (`idevent` ASC) VISIBLE,
  INDEX `annexe_idx` (`idannexe` ASC) VISIBLE,
  CONSTRAINT `event`
    FOREIGN KEY (`idevent`)
    REFERENCES `mydb`.`event` (`id_event`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `annexe`
    FOREIGN KEY (`idannexe`)
    REFERENCES `mydb`.`annexes` (`id_annex`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`daysoff`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`daysoff` (
  `id_dayoff` INT NOT NULL,
  `dayoff_type` VARCHAR(45) NULL,
  `dayoff_max` INT NULL,
  UNIQUE INDEX `id_dayoff_UNIQUE` (`id_dayoff` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `nounous`.`contract`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`contract` (
  `id_contract` INT NOT NULL,
  `starting_date` DATE NOT NULL,
  `ending_date` DATE NULL,
  PRIMARY KEY (`id_contract`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`prices`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`prices` (
  `id_prices` INT NOT NULL,
  `price_hour` DECIMAL(2) NULL,
  `price_household` DECIMAL(2) NULL,
  `price_long_household` DECIMAL(2) NULL,
  `price_meal` DECIMAL(2) NULL,
  `price_snack` DECIMAL(2) NULL,
  `price_over_hour` DECIMAL(2) NULL,
  UNIQUE INDEX `id_Version_UNIQUE` (`id_prices` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`cycle`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cycle` (
  `id_cycle` INT NOT NULL,
  `week` INT NOT NULL DEFAULT id of a week in a cycle,
  `monday_start` DATETIME NULL,
  `tuesday_start` DATETIME NULL,
  `wednesday_start` DATETIME NULL,
  `thursday_start` DATETIME NULL,
  `friday_start` DATETIME NULL,
  `monday_duration` DECIMAL(2) NULL,
  `tuesday_duration` DECIMAL(2) NULL,
  `wednesday_duration` DECIMAL(2) NULL,
  `thursday_duration` DECIMAL(2) NULL,
  `friday_duration` DECIMAL(2) NULL)
ENGINE = InnoDB
PACK_KEYS = Default;


-- -----------------------------------------------------
-- Table `mydb`.`durations`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`durations` (
  `id_durations` INT NOT NULL,
  `weeks_per_year` INT NULL DEFAULT nb de semaines par an, calcul manuel au contrat,
  `weeks_per_cycle` INT NULL DEFAULT nombre de semaines dans un cycle, par défaut 1,
  `cycle_id` INT NULL,
  PRIMARY KEY (`id_durations`),
  INDEX `id_cycle_idx` (`cycle_id` ASC) VISIBLE,
  CONSTRAINT `id_cycle`
    FOREIGN KEY (`cycle_id`)
    REFERENCES `mydb`.`cycle` (`id_cycle`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`version`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`version` (
  `id_Version` INT NOT NULL,
  `contract_id` INT NOT NULL,
  `starting_date` DATE NULL,
  `durations_id` INT NULL,
  `prices_id` INT NULL,
  `regulation_at_end` DECIMAL(2) NULL DEFAULT en cas de version dont la durée serait != de 12 mois, régulation en € possible,
  INDEX `id_contract_idx` (`contract_id` ASC) VISIBLE,
  INDEX `id_prices_idx` (`prices_id` ASC) VISIBLE,
  INDEX `id_durations_idx` (`durations_id` ASC) VISIBLE,
  CONSTRAINT `id_contract`
    FOREIGN KEY (`contract_id`)
    REFERENCES `nounous`.`contract` (`id_contract`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `id_prices`
    FOREIGN KEY (`prices_id`)
    REFERENCES `mydb`.`prices` (`id_prices`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `id_durations`
    FOREIGN KEY (`durations_id`)
    REFERENCES `mydb`.`durations` (`id_durations`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `nounous`.`role`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`role` (
  `id_role` INT NOT NULL AUTO_INCREMENT,
  `role` VARCHAR(45) NULL DEFAULT NULL COMMENT 'Admin\\nParent\\nassMat\\n',
  PRIMARY KEY (`id_role`),
  UNIQUE INDEX `id_role_UNIQUE` (`id_role` ASC) VISIBLE,
  UNIQUE INDEX `role_UNIQUE` (`role` ASC) VISIBLE)
ENGINE = InnoDB
AUTO_INCREMENT = 5
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `nounous`.`user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`user` (
  `id_user` INT NOT NULL AUTO_INCREMENT,
  `lastname` VARCHAR(45) NULL DEFAULT NULL,
  `firstname` VARCHAR(45) NOT NULL,
  `role_id` INT NOT NULL COMMENT 'Parent = TRUE\\nassmat = FALSE\\n',
  PRIMARY KEY (`id_user`),
  UNIQUE INDEX `id_user_UNIQUE` (`id_user` ASC) VISIBLE,
  INDEX `id_role_idx` (`role_id` ASC) VISIBLE,
  CONSTRAINT `id_role`
    FOREIGN KEY (`role_id`)
    REFERENCES `nounous`.`role` (`id_role`))
ENGINE = InnoDB
AUTO_INCREMENT = 3
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`login`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`login` (
  `user_id` INT NOT NULL,
  `hashed_password` VARCHAR(200) NULL,
  `email` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`user_id`),
  CONSTRAINT `id_user`
    FOREIGN KEY (`user_id`)
    REFERENCES `nounous`.`user` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `nounous`.`event_type`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`event_type` (
  `id_event_type` INT NOT NULL AUTO_INCREMENT,
  `type` VARCHAR(45) NOT NULL COMMENT '- Garde prévue\\n- Durée Supplémentaire\\n- Absence nounou\\n- Absence enfant\\n- Maladie enfant\\n- Congé\\n- Férié payé\\n- Férié travaillé \\n- Férié gratuit\\n- Formation nounou',
  `unit` VARCHAR(10) NULL COMMENT 'Heures\\nJours\\nSemaines\\n',
  `is_paid` TINYINT(1) NULL,
  PRIMARY KEY (`id_event_type`),
  UNIQUE INDEX `idEvent_UNIQUE` (`id_event_type` ASC) VISIBLE,
  UNIQUE INDEX `eventType_UNIQUE` (`type` ASC) VISIBLE)
ENGINE = InnoDB
AUTO_INCREMENT = 1
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `mydb`.`event`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`event` (
  `event_id` INT NOT NULL,
  `contract_id` INT NOT NULL,
  `event_type_id` INT NOT NULL,
  `starting_date` DATETIME NOT NULL,
  `ending_date` DATETIME NOT NULL,
  INDEX `id_event_type_idx` (`event_type_id` ASC) VISIBLE,
  INDEX `id_contract_idx` (`contract_id` ASC) VISIBLE,
  UNIQUE INDEX `event_id_UNIQUE` (`event_id` ASC) VISIBLE,
  CONSTRAINT `id_contract`
    FOREIGN KEY (`contract_id`)
    REFERENCES `nounous`.`contract` (`id_contract`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `id_event_type`
    FOREIGN KEY (`event_type_id`)
    REFERENCES `nounous`.`event_type` (`id_event_type`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

USE `nounous` ;

-- -----------------------------------------------------
-- Table `nounous`.`kid`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`kid` (
  `id_kid` INT NOT NULL AUTO_INCREMENT,
  `lastname` VARCHAR(45) NULL,
  `firstname` VARCHAR(45) NULL,
  `birthdate` DATE NOT NULL,
  PRIMARY KEY (`id_kid`))
ENGINE = InnoDB
AUTO_INCREMENT = 2
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `nounous`.`schedule`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`schedule` (
  `id_schedule` INT NOT NULL,
  `id_Cycle` INT NULL DEFAULT NULL COMMENT 'Numéro de la semaine d’un cycle de plusieurs semaines',
  `day` INT NOT NULL COMMENT '1: lundi\\n2: mardi\\n3: mercredi\\n4: jeudi\\n5: vendredi\\n6: samedi\\n7: dimanche\\n8: lundi + mardi + jeudi + vendredi\\n9: L M M J V',
  `start` DATETIME NOT NULL COMMENT 'Heure de début de ce jour',
  `end` DATETIME NOT NULL COMMENT 'Heure de fin de ce jour',
  `gouter` INT NULL DEFAULT NULL COMMENT 'Nombre de goûter/collation de ce jour\\n',
  `repas` INT NULL DEFAULT NULL COMMENT 'Nombre de repas de ce jour\\n',
  PRIMARY KEY (`id_schedule`),
  CONSTRAINT `id_Annexe`
    FOREIGN KEY (`id_schedule`)
    REFERENCES `nounous`.`annexe` (`idAnnexe`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `nounous`.`id_vacation_type`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`id_vacation_type` (
  `id_vacation_type` INT NOT NULL,
  `details` VARCHAR(45) NOT NULL COMMENT 'Congés annuels: 0\\nCongés familiaux: 1',
  PRIMARY KEY (`id_vacation_type`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `nounous`.`user_contract`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`user_contract` (
  `contract_id` INT NOT NULL COMMENT 'Id contrat FK',
  `user_id` INT NOT NULL COMMENT 'Parent ou assmat',
  `kid_id` INT NOT NULL COMMENT 'Enfant concerné par le contrat',
  `is_main` TINYINT NOT NULL COMMENT 'Contrat principal TRUE\\nContrat de remplacement FALSE',
  INDEX `id_kid_idx` (`kid_id` ASC) VISIBLE,
  INDEX `id_user_idx` (`user_id` ASC) VISIBLE,
  INDEX `id_contract_idx` (`contract_id` ASC) VISIBLE,
  CONSTRAINT `id_contract`
    FOREIGN KEY (`contract_id`)
    REFERENCES `nounous`.`contract` (`id_contract`),
  CONSTRAINT `id_kid`
    FOREIGN KEY (`kid_id`)
    REFERENCES `nounous`.`kid` (`id_kid`),
  CONSTRAINT `id_user`
    FOREIGN KEY (`user_id`)
    REFERENCES `nounous`.`user` (`id_user`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `nounous`.`vacation`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `nounous`.`vacation` (
  `id_vacation` INT NOT NULL,
  `contract_id` INT NOT NULL,
  `dateAcquire` DATE NULL DEFAULT NULL,
  `dateTaken` DATE NULL DEFAULT NULL,
  `dateLimit` DATE NULL DEFAULT NULL,
  `quantity` DECIMAL(2) NULL DEFAULT NULL COMMENT '2,5 par mois',
  `vacation_type_id` INT NOT NULL,
  PRIMARY KEY (`id_vacation`),
  INDEX `idContrat_idx` (`contract_id` ASC) VISIBLE,
  CONSTRAINT `idContrat`
    FOREIGN KEY (`contract_id`)
    REFERENCES `nounous`.`contract` (`id_contract`),
  CONSTRAINT `idEvent`
    FOREIGN KEY (`id_vacation`)
    REFERENCES `nounous`.`calendar` (`idEvent`),
  CONSTRAINT `idTypeVacation`
    FOREIGN KEY (`id_vacation`)
    REFERENCES `nounous`.`id_vacation_type` (`id_vacation_type`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;

USE `nounou` ;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `mydb`.`user`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`user` (`id_user`, `firstname`, `lastname`, `role`) VALUES (1, 'Dupont', 'Damien', 'parent');
INSERT INTO `mydb`.`user` (`id_user`, `firstname`, `lastname`, `role`) VALUES (DEFAULT, 'Séjour', 'Clémence', 'parent');
INSERT INTO `mydb`.`user` (`id_user`, `firstname`, `lastname`, `role`) VALUES (DEFAULT, 'S', 'Isabelle', 'nounou');
INSERT INTO `mydb`.`user` (`id_user`, `firstname`, `lastname`, `role`) VALUES (DEFAULT, 'admin', 'alpha', 'admin');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`hollidays_paiement`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`hollidays_paiement` (`id_rythme`, `choice`, `rythm`) VALUES (1, 'annuel', '12');
INSERT INTO `mydb`.`hollidays_paiement` (`id_rythme`, `choice`, `rythm`) VALUES (2, 'semestriel', '6');
INSERT INTO `mydb`.`hollidays_paiement` (`id_rythme`, `choice`, `rythm`) VALUES (3, 'à la prise', 'vacances');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`event`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'prévu');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'weekend');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'pas de garde');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'congés');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'férié');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'au réel');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'accueil exceptionnel');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'absence nounou');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'absence enfant');
INSERT INTO `mydb`.`event` (`id_event`, `event`) VALUES (DEFAULT, 'heures complémentaires');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`schedule`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`schedule` (`idplanning`, `idannexe`, `semaine`, `jour`, `idevent`, `debut`, `duree`) VALUES (1, 1, 1, 1, NULL, '084500', 9);
INSERT INTO `mydb`.`schedule` (`idplanning`, `idannexe`, `semaine`, `jour`, `idevent`, `debut`, `duree`) VALUES (1, 1, 1, 2, NULL, '084500', 9);
INSERT INTO `mydb`.`schedule` (`idplanning`, `idannexe`, `semaine`, `jour`, `idevent`, `debut`, `duree`) VALUES (1, 1, 1, 3, NULL, NULL, NULL);
INSERT INTO `mydb`.`schedule` (`idplanning`, `idannexe`, `semaine`, `jour`, `idevent`, `debut`, `duree`) VALUES (1, 1, 1, 4, NULL, '084500', 9);
INSERT INTO `mydb`.`schedule` (`idplanning`, `idannexe`, `semaine`, `jour`, `idevent`, `debut`, `duree`) VALUES (1, 1, 1, 5, NULL, '084500', 9);
INSERT INTO `mydb`.`schedule` (`idplanning`, `idannexe`, `semaine`, `jour`, `idevent`, `debut`, `duree`) VALUES (1, 1, 1, 6, NULL, NULL, NULL);
INSERT INTO `mydb`.`schedule` (`idplanning`, `idannexe`, `semaine`, `jour`, `idevent`, `debut`, `duree`) VALUES (1, 1, 1, 7, NULL, NULL, NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `nounous`.`contract`
-- -----------------------------------------------------
START TRANSACTION;
USE `nounous`;
INSERT INTO `nounous`.`contract` (`id_contract`, `starting_date`, `ending_date`) VALUES (1, '01/05/2021', NULL);
INSERT INTO `nounous`.`contract` (`id_contract`, `starting_date`, `ending_date`) VALUES (2, '01/10/2022', '01/11/2022');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`prices`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`prices` (`id_prices`, `price_hour`, `price_household`, `price_long_household`, `price_meal`, `price_snack`, `price_over_hour`) VALUES (1, 3.8, 2.65, 3.5, 1.5, 3.39, NULL);
INSERT INTO `mydb`.`prices` (`id_prices`, `price_hour`, `price_household`, `price_long_household`, `price_meal`, `price_snack`, `price_over_hour`) VALUES (2, 3.8, 2.65, 3.5, 1.5, 3.39, NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`cycle`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`cycle` (`id_cycle`, `week`, `monday_start`, `tuesday_start`, `wednesday_start`, `thursday_start`, `friday_start`, `monday_duration`, `tuesday_duration`, `wednesday_duration`, `thursday_duration`, `friday_duration`) VALUES (3, 1, '7:50', '7:50', '0', '7:50', '7:50', 9.33, 9.33, 9.33, 9.33, 9.33);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`durations`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`durations` (`id_durations`, `weeks_per_year`, `weeks_per_cycle`, `cycle_id`) VALUES (1, 33, 1, 1);
INSERT INTO `mydb`.`durations` (`id_durations`, `weeks_per_year`, `weeks_per_cycle`, `cycle_id`) VALUES (2, 36, 1, 2);
INSERT INTO `mydb`.`durations` (`id_durations`, `weeks_per_year`, `weeks_per_cycle`, `cycle_id`) VALUES (3, 29.81, 1, 3);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`version`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`version` (`id_Version`, `contract_id`, `starting_date`, `durations_id`, `prices_id`, `regulation_at_end`) VALUES (1, 1, '01/05/2021', 1, 1, NULL);
INSERT INTO `mydb`.`version` (`id_Version`, `contract_id`, `starting_date`, `durations_id`, `prices_id`, `regulation_at_end`) VALUES (2, 1, '01/03/2022', 2, 2, NULL);
INSERT INTO `mydb`.`version` (`id_Version`, `contract_id`, `starting_date`, `durations_id`, `prices_id`, `regulation_at_end`) VALUES (3, 1, '01/09/2022', 3, 3, NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `nounous`.`role`
-- -----------------------------------------------------
START TRANSACTION;
USE `nounous`;
INSERT INTO `nounous`.`role` (`id_role`, `role`) VALUES (1, 'parent');
INSERT INTO `nounous`.`role` (`id_role`, `role`) VALUES (2, 'assistante');
INSERT INTO `nounous`.`role` (`id_role`, `role`) VALUES (3, 'admin');

COMMIT;


-- -----------------------------------------------------
-- Data for table `nounous`.`user`
-- -----------------------------------------------------
START TRANSACTION;
USE `nounous`;
INSERT INTO `nounous`.`user` (`id_user`, `lastname`, `firstname`, `role_id`) VALUES (1, 'D', 'Damien', 1);
INSERT INTO `nounous`.`user` (`id_user`, `lastname`, `firstname`, `role_id`) VALUES (2, 'S', 'Isabelle', 2);
INSERT INTO `nounous`.`user` (`id_user`, `lastname`, `firstname`, `role_id`) VALUES (3, 'DD', DEFAULT, 3);
INSERT INTO `nounous`.`user` (`id_user`, `lastname`, `firstname`, `role_id`) VALUES (4, 'who', 'remplaçante', 2);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`login`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`login` (`user_id`, `hashed_password`, `email`) VALUES (1, NULL, DEFAULT);
INSERT INTO `mydb`.`login` (`user_id`, `hashed_password`, `email`) VALUES (2, NULL, DEFAULT);
INSERT INTO `mydb`.`login` (`user_id`, `hashed_password`, `email`) VALUES (3, NULL, DEFAULT);
INSERT INTO `mydb`.`login` (`user_id`, `hashed_password`, `email`) VALUES (4, NULL, DEFAULT);

COMMIT;


-- -----------------------------------------------------
-- Data for table `nounous`.`event_type`
-- -----------------------------------------------------
START TRANSACTION;
USE `nounous`;
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (1, 'garde imprévue', 'jour', 1);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (2, 'heures sup', 'heure', 1);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (3, 'absence nounou journée', 'jour', 0);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (4, 'absence nounou heures', 'heure', 0);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (5, 'absence enfant journée', 'jour', 1);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (6, 'absence enfant heures', 'heure', 1);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (7, 'enfant malade', 'jour', 0);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (8, 'congé', 'jour', 0);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (9, 'formation', 'jour', 1);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (10, 'férié non payé', 'jour', 0);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (11, 'férié payé', 'jour', 1);
INSERT INTO `nounous`.`event_type` (`id_event_type`, `type`, `unit`, `is_paid`) VALUES (12, 'garde prévue', 'jour', 1);

COMMIT;


-- -----------------------------------------------------
-- Data for table `nounous`.`kid`
-- -----------------------------------------------------
START TRANSACTION;
USE `nounous`;
INSERT INTO `nounous`.`kid` (`id_kid`, `lastname`, `firstname`, `birthdate`) VALUES (1, 'D', 'Margot', '18/10/2020');

COMMIT;


-- -----------------------------------------------------
-- Data for table `nounous`.`user_contract`
-- -----------------------------------------------------
START TRANSACTION;
USE `nounous`;
INSERT INTO `nounous`.`user_contract` (`contract_id`, `user_id`, `kid_id`, `is_main`) VALUES (1, 1, 1, 1);
INSERT INTO `nounous`.`user_contract` (`contract_id`, `user_id`, `kid_id`, `is_main`) VALUES (1, 2, 1, 1);
INSERT INTO `nounous`.`user_contract` (`contract_id`, `user_id`, `kid_id`, `is_main`) VALUES (2, 1, 1, 0);
INSERT INTO `nounous`.`user_contract` (`contract_id`, `user_id`, `kid_id`, `is_main`) VALUES (2, 4, 1, 0);

COMMIT;

